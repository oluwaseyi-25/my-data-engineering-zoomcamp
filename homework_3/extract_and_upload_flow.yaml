id: extract_and_upload_flow
namespace: zoomcamp.seyi

inputs:
  - id: year
    type: SELECT
    values: ["2023", "2024", "2025"]
    defaults: "2024"
  
  - id: month
    type: SELECT
    values: ["01", "02", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12"]
    defaults: "01"

variables:
  - file: "{{yellow_tripdata_{{inputs.year}}-{{inputs.month}}.parquet}}"
  - file_url: "https://d37ci6vzurychx.cloudfront.net/trip-data/{{render(vars.file)}}"
  - gcs_file: "gs://{{kv('GCP_BUCKET_NAME')}}/{{render(vars.file)}}"

tasks:
  - id: set_labels
    type: io.kestra.plugin.core.execution.Labels
    labels:
      file: "{{render(vars.file)}}"